$server = @()
Get-ADGroupMember -Server $server -identity "Passwdreset_GlobalES" | select SamAccountName -ExpandProperty SamAccountName | ForEach-Object { get-aduser -Server $server -filter { SamAccountName -eq $_ } -properties UserPrincipalName, CannotChangePassword, SamAccountName, pwdlastset | where { ($_.CannotChangePassword -eq $true) -and ($_.pwdlastset -eq 0) } | set-aduser -CannotchangePassword $false -confirm}
Get-ADGroupMember -Server $server -identity "Passwdreset_GlobalAR" | select SamAccountName -ExpandProperty SamAccountName | ForEach-Object { get-aduser -Server $server -filter { SamAccountName -eq $_ } -properties UserPrincipalName, CannotChangePassword, SamAccountName, pwdlastset | where { ($_.CannotChangePassword -eq $true) -and ($_.pwdlastset -eq 0) } | set-aduser -CannotchangePassword $false -confirm}
Get-ADGroupMember -Server $server -identity "Passwdreset_GlobalCL" | select SamAccountName -ExpandProperty SamAccountName | foreach-object { get-aduser -Server $server -filter {SamAccountName -eq $_} -properties UserPrincipalName, CannotChangePassword, SamAccountName, pwdlastset | where { ($_.CannotChangePassword -eq $true) -and ($_.pwdlastset -eq 0)} | set-aduser -CannotchangePassword $false -confirm}
Get-ADGroupMember -Server $server -identity "Passwdreset_GlobalIT" | select SamAccountName -ExpandProperty SamAccountName | foreach-object { get-aduser -Server $server -filter {SamAccountName -eq $_} -properties UserPrincipalName, CannotChangePassword, SamAccountName, pwdlastset | where { ($_.CannotChangePassword -eq $true) -and ($_.pwdlastset -eq 0)} | set-aduser -CannotchangePassword $false -confirm}
Get-ADGroupMember -Server $server -identity "Passwdreset_GlobalPE" | select SamAccountName -ExpandProperty SamAccountName | foreach-object { get-aduser -Server $server -filter {SamAccountName -eq $_} -properties UserPrincipalName, CannotChangePassword, SamAccountName, pwdlastset | where { ($_.CannotChangePassword -eq $true) -and ($_.pwdlastset -eq 0)} | set-aduser -CannotchangePassword $false -confirm}
Get-ADGroupMember -Server $server -identity "Passwdreset_GlobalPT" | select SamAccountName -ExpandProperty SamAccountName | foreach-object { get-aduser -Server $server -filter {SamAccountName -eq $_} -properties UserPrincipalName, CannotChangePassword, SamAccountName, pwdlastset | where { ($_.CannotChangePassword -eq $true) -and ($_.pwdlastset -eq 0)} | set-aduser -CannotchangePassword $false -confirm}
Get-ADGroupMember -Server $server -identity "Passwdreset_GlobalUK" | select SamAccountName -ExpandProperty SamAccountName | foreach-object { get-aduser -Server $server -filter {SamAccountName -eq $_} -properties UserPrincipalName, CannotChangePassword, SamAccountName, pwdlastset | where { ($_.CannotChangePassword -eq $true) -and ($_.pwdlastset -eq 0)} | set-aduser -CannotchangePassword $false -confirm}